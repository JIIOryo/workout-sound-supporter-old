<!doctype html>
<html lang="ja">
    <head>
        <meta charset="utf-8">
        <title>{{ menu.training_name }}を編集</title>
        <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/main.css') }}">
    </head>
    <body>
        <div id="app">
            <h1>{{ menu.training_name }}を編集</h1>


            <table>
                <tr>
                    <td><p>トレーニング名</p></td>
                    <td><input type="text" v-model="training.training_name"></td>
                </tr>
                <tr>
                    <td><p>作者</p></td>
                    <td><input type="text" v-model="training.author"></td>
                </tr>
                <tr>
                    <td><p>メニュー</p></td>
                    <td>
                        <div v-for="(menu, i) of training.menu" :key="i" class="menu-box">
                            <div class="delete-menu-button-box">
                                <button @click="deleteMenu(i)">削除</button>
                            </div>
                            <table>
                                <tr>
                                    <td>筋トレ名</td>
                                    <td><input type="text" v-model="menu.work_out_name"></td>
                                </tr>
                                <tr>
                                    <td>回数</td>
                                    <td><input type="text" v-model="menu.times"></td>
                                </tr>
                                <tr>
                                    <td>セット数</td>
                                    <td><input type="text" v-model="menu.sets"></td>
                                </tr>
                                <tr>
                                    <td>休憩時間</td>
                                    <td><input type="text" v-model="menu.after_interval"></td>
                                </tr>
                            </table> 
                        </div>
                        <div>
                            <button @click="addMenu">メニューを追加</button>
                        </div>
                    </td>
                </tr>
            </table>



            <a href='/'><button>戻る</button></a>
        </div>
    </body>
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios@0.18.0/dist/axios.min.js"></script>
    <script>
var app = new Vue({
    el: '#app',
    data: {
        hasError: false,
        loading: true,
        training: {
            id: null,
            training_name: null,
            author: null,
            menu: []
        }
    },
    mounted: function() {
        axios.get('/work_out/{{ menu.id }}')
            .then(function(response) {
                this.training = response.data
                console.log(this.menu)
            }.bind(this))
            .catch(function(error){
                console.log(error)
                this.hasError = true;
            }.bind(this))
            .finally(function(){
                this.loading = false;
            }.bind(this))      
    },
    methods: {
        addMenu: function() {
            this.training.menu.push({
                work_out_name: '',
                length: '',
                times: '',
                sets: ''
            });
        },
        deleteMenu: function(i) {
            this.training.menu.splice(i, 1);
        }
    }
})
</script>
</html>
